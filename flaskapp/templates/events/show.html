{% extends 'layouts/events/show.html' %}
{% block title %}Events - {{ event.name }}{% endblock %}
{% block container %}
  <div class="row">
    <div class="col-sm-12 col-md-12">
      <h3>{{ event.name }}</h3>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">
      <h4><strong>Details</strong></h4>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12"><strong>Location</strong></div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">{{ event.address }}</div>
  </div>
  {% if event.address_line_two %}
    <div class="row">
      <div class="col-sm-12 col-md-12">{{ event.address_line_two }}</div>
    </div>
  {% endif %}
  <div class="row">
    <div class="col-sm-4 col-md-5">
        {{ event.city }}, {{ event.state }} {{ event.zip_code }}
    </div>
    <div class="col-sm-8 col-md-7">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12"><strong>Time</strong></div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-2 col-md-3">Start</div>
    <div class="col-sm-2 col-md-3">End</div>
    <div class="col-sm-2 col-md-2">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-3 col-md-3">{{ moment(event.start_date).format('MM-D-YYYY, h:mm a') }}</div>
    <div class="col-sm-3 col-md-3">{{ moment(event.end_date).format('MM-D-YYYY, h:mm a') }}</div>
    <div class="col-sm-3 col-md-2">
      {% if event.user_id == u_id %}
        <a href="{{ url_for('events.update', event_id=event.id) }}" class="btn btn-primary btn-xs">
          Edit Details
        </a>
      {% endif %}
    </div>
    <div class="col-sm-3 col-md-1">&nbsp;</div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">&nbsp;</div>
  </div>
  {% if event.user_id == u_id %}
    <div class="row">
      <div class="col-sm-12 col-md-12"><h4><strong>Guests</strong></h4></div>
    </div>
    {% for g in guests %}
      <div class="row">
        <div class="col-sm-5 col-md-12">{{ g.email }}</div>
      </div>
      <div class="row">
        <div class="col-sm-12 col-md-12">&nbsp;</div>
      </div>
    {% endfor %}
    <div class="row">
      <div class="col-sm-12 col-md-12">&nbsp;</div>
    </div>
  {% endif %}
  <div class="row">
    <div class="col-sm-12 col-md-12"><h4><strong>Items</strong></h4></div>
  </div>
  <div class="row">
    <div class="col-sm-12 col-md-12">&nbsp;</div>
  </div>
  {% raw %}
    <div class="top-pad" ng-app="eventsApp" ng-controller="eventsCtrl" ng-cloak>
      <form name="eventsForm" role="form" novalidate>
        <div ng-repeat="item in params.items_data">
          <div class="row">
            <div class="col-sm-2 col-md-3"><strong>Name:</strong> {{ item.name }}</div>
            <div class="col-sm-2 col-md-2">Quantity: {{ item.quantity }}</div>
            <div class="col-sm-2 col-md-2">Claimed: {{ item.quantity_claimed }}</div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-12">&nbsp;</div>
          </div>
          <div class="row">
            <div class="col-sm-2 col-md-2">
              <div class="form-group">
                <label for="{{'tb-item-quantity-claimed-' + item.id}}">Claim</label>
                <input type="text"
                       id="{{'tb-item-quantity-claimed-' + item.id}}"
                       class="form-control"
                       ng-model="item.quantity_claimed_new">
              </div>
            </div>
            <div class="col-sm-1 col-md-1">
              <div>&nbsp;</div>
              <button type="button" class="btn btn-success btn-xs" ng-click="claimItem(item.id)">Claim</button>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-12">&nbsp;</div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-12">&nbsp;</div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-12"><strong>Claimed By Guests</strong></div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-12">&nbsp;</div>
          </div>
          <div ng-repeat="subitem in item.subitems">
            <!--
            <div class="row">
              <div class="col-sm-2 col-md-2">User: {{ subitem.user_id }}</div>
              <div class="col-sm-2 col-md-2">Quantity: {{ subitem.quantity }}</div>
            </div>
            -->
            <div class="row">
              <div class="col-sm-2 col-md-2">User: {{ subitem.user_id }}</div>
              <div class="col-sm-2 col-md-2">
                <div class="form-group">
                  <label for="{{'tb-subitem-quantity-' + subitem.id}}">Quantity</label>
                  <input type="text"
                         id="{{'tb-subitem-quantity-' + subitem.id}}"
                         class="form-control"
                         ng-model="subitem.quantity">
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12 col-md-12">&nbsp;</div>
            </div>
          </div>
          <!--End Subitems -->
          <div class="row">
            <div class="col-sm-12 col-md-12">&nbsp;</div>
          </div>
          <div class="row">
            <hr >
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-12">&nbsp;</div>
          </div>
        </div>
        <!-- End Items -->
        <div class="row">
          <div class="col-sm-1 col-md-1">
            <button type="button" class="btn btn-primary btn-sm" ng-click="claimItems()">Claim Items</button>
          </div>
          <div class="col-sm-5 col-md-5">&nbsp;</div>
        </div>
      </form>
      <div class="row">
        <div class="col-sm-12 col-md-12">&nbsp;</div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <h4>JSON Object</h4>
          <div>&nbsp;</div>
          <button type="button" class="btn btn-sm btn-info" ng-click="toggleEventObjView = !toggleEventObjView" >View</button>
          <div>&nbsp;</div>
          <pre ng-show="toggleEventObjView">{{ params | json }}</pre>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12 col-md-12">&nbsp;</div>
      </div>
    </div>
  {% endraw %}
  <div class="row">
    <div class="col-sm-5 col-md-5">&nbsp;</div>
    <div class="col-sm-1 col-md-1">
      <a href="{{ url_for('events.index') }}" class="btn btn-warning btn-sm">
        Back
      </a>
    </div>
    <div class="col-sm-5 col-md-5">&nbsp;</div>
  </div>

{% endblock %}
